<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/main}"
      lang="id">
<head>
    <title>Draft Transaksi</title>
</head>
<body>
    <h1 id="page-title" layout:fragment="page-title">Draft Transaksi</h1>

    <div id="drafts-list-content" layout:fragment="content" class="h-full flex flex-col">
        <!-- Header Actions -->
        <div class="flex flex-col lg:flex-row lg:items-center justify-between gap-4 mb-4 flex-shrink-0">
            <!-- Filters Row -->
            <form id="filter-form" th:action="@{/drafts}" method="get"
                  hx-get="/drafts"
                  hx-target="#draft-table"
                  hx-swap="outerHTML"
                  hx-push-url="true"
                  class="flex flex-wrap items-center gap-2">
                <!-- Status Filter -->
                <select id="filter-status" name="status"
                        hx-get="/drafts"
                        hx-target="#draft-table"
                        hx-swap="outerHTML"
                        hx-push-url="true"
                        hx-include="#filter-form"
                        class="px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500">
                    <option value="">Semua Status</option>
                    <option th:each="s : ${statuses}" th:value="${s.name()}"
                            th:text="${s.name() == 'PENDING' ? 'Menunggu Review' : (s.name() == 'APPROVED' ? 'Disetujui' : (s.name() == 'REJECTED' ? 'Ditolak' : 'Auto-Approved'))}"
                            th:selected="${selectedStatus == s.name()}">Status</option>
                </select>

                <button type="submit" class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                    Filter
                </button>
            </form>

            <!-- Pending Badge -->
            <div th:if="${pendingCount > 0}" class="flex items-center">
                <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800">
                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                    <span th:text="${pendingCount}">0</span> menunggu review
                </span>
            </div>
        </div>

        <!-- Draft Table -->
        <th:block th:insert="~{fragments/draft-table :: table}"/>
    </div>
</body>
</html>
