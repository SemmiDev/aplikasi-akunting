# Release 2025.12.4

Patch release focused on transaction UI improvements, double-submission prevention, and mobile responsiveness.

## Highlights

- **Transaction Form UX Overhaul**: Quick transaction FAB with smart template picker and auto-reload
- **Double-Submission Prevention**: Both frontend and backend protection using optimistic locking
- **Mobile Responsive**: Transaction table now fully responsive for mobile devices
- **Improved Reliability**: Multiple UI bug fixes and test isolation improvements

## What's New

### Transaction UI Enhancements

**Quick Transaction FAB**
- Floating Action Button for rapid transaction entry
- Smart template picker shows recently used templates first
- Modal-based form with improved UX
- Auto-reload transaction list after submission

**Double-Submission Prevention**
- Frontend prevention: Disable submit button during processing
- Backend protection: Optimistic locking with version control
- Prevents duplicate transactions from rapid clicking or network issues

### Mobile Responsiveness

**Transaction Table**
- Fully responsive design for mobile devices
- Proper card-based layout on small screens
- Fixed HTML structure issues causing row duplication

## Improvements

### User Experience

- Improved quick transaction modal UX with better loading states
- Draft transaction edit form now preselects previously chosen accounts
- Journal preview now displayed for draft transactions in detail view
- Quick transaction form HTMX loading issues resolved

### Developer Experience

- Ubuntu setup script for test environment configuration
- Isolated test context to prevent state sharing between tests
- CSV import now trims whitespace from field values automatically

### Documentation

- Fixed education industry manual issues on live site
- Clarified that GitHub Actions auto-creates releases (no manual gh release needed)

## Bug Fixes

### UI Fixes
- Fixed invalid HTML structure causing row duplication in transaction list
- Fixed draft transaction edit form variable scope in Thymeleaf
- Fixed quick transaction form submission and HTMX loading
- Fixed journal preview not showing for draft transactions

### Backend Fixes
- Resolved detached entity error when creating/duplicating templates
- Resolved two security regression test failures
- Fixed test context isolation in SellerTransactionExecutionTest

### Data Quality
- CSV import now properly trims whitespace from field values

## Breaking Changes

None - all changes are backward compatible.

## Migration Guide

Standard upgrade path from 2025.12.3-RELEASE:

1. Pull latest code
2. Run `./mvnw clean package`
3. Deploy using standard procedure in `docs/03-operations-guide.md`

No database migrations or data changes required.

## Known Issues

None

## Technical Details

### Optimistic Locking Implementation

All entities now extend `BaseEntity` with:
- `@Version Long version` field for optimistic locking
- Automatic version increment on updates
- `OptimisticLockException` thrown on concurrent modification
- Handled in `RestExceptionHandler` with HTTP 409 Conflict

### Test Improvements

- `SellerTransactionExecutionTest` now uses `@DirtiesContext` to isolate context
- Prevents state sharing that caused intermittent test failures
- All functional tests remain stable with data-testid locators

## Dependencies

- Java 25
- Spring Boot 4.0.0
- PostgreSQL 17
- Playwright 1.50.0

## Contributors

Thanks to everyone who contributed to this release!

- Claude Sonnet 4.5 (AI pair programming)
- Endy Muhardin (lead developer)
